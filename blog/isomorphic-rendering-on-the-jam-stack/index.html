<!doctype html><html lang="en" class="dark-theme theme-ruby"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="preload" href="/fonts/placardmtstd-cond-webfont.woff2" as="font" type="font/woff2" crossorigin><style>code{font-family:Menlo, Monaco, "Courier New", monospace;font-size:0.8em}code[class*="language-"],pre[class*="language-"]{-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;white-space:pre;white-space:pre-wrap;word-wrap:normal;font-family:Menlo, Monaco, "Courier New", monospace;line-height:1.8;color:#76d9e6;text-shadow:none}pre[class*="language-"],:not(pre)>code[class*="language-"]{background:#2a2a2a}pre[class*="language-"]{padding:2em;margin:0.5em -2em;border-radius:4px;overflow:auto}pre[class*="language-"]{position:relative}pre[class*="language-"] code{white-space:pre;display:block}:not(pre)>code[class*="language-"]{padding:0.15em 0.2em 0.05em;border-radius:.3em;border:0.13em solid #7a6652;box-shadow:1px 1px 0.3em -0.1em #000 inset}.token.namespace{opacity:.7}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:#6f705e}.token.operator,.token.boolean,.token.number{color:#a77afe}.token.attr-name,.token.string{color:#e6d06c}.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#e6d06c}.token.selector,.token.inserted{color:#a6e22d}.token.atrule,.token.attr-value,.token.keyword,.token.important,.token.deleted{color:#ef3b7d}.token.regex,.token.statement{color:#76d9e6}.token.placeholder,.token.variable{color:#fff}.token.important,.token.statement,.token.bold{font-weight:bold}.token.punctuation{color:#bebec5}.token.entity{cursor:help}.token.italic{font-style:italic}code.language-markup{color:#f9f9f9}code.language-markup .token.tag{color:#ef3b7d}code.language-markup .token.attr-name{color:#a6e22d}code.language-markup .token.attr-value{color:#e6d06c}code.language-markup .token.style,code.language-markup .token.script{color:#76d9e6}code.language-markup .token.script .token.keyword{color:#76d9e6}mark.highlight-line{color:inherit;background-color:rgba(255,255,255,0.08);display:inline-block}.theme-ruby{--theme-base: 158, 48, 40}.theme-black{--theme-base:34, 34, 34}.theme-red{--theme-base:175, 42, 64}.theme-blue{--theme-base:59, 88, 162}.theme-brightblue{--theme-base:36, 107, 189}.theme-darkblue{--theme-base:62, 78, 117}.theme-greyblue{--theme-base:50, 61, 62}.theme-lime{--theme-base:123, 137, 45}.theme-seagreen{--theme-base:87, 134, 113}.theme-sepia{--theme-base:86, 80, 67}.theme-steelblue{--theme-base: 91, 117, 137}.theme-teal{--theme-base: 48, 165, 156}.theme-khaki{--theme-base: 179, 175, 112}.theme-neonblue{--theme-base: 30, 235, 250}.theme-neongreen{--theme-base: 173, 247, 0}.theme-nearwhite{--theme-base: 245, 245, 245}.dark-theme{background-color:rgba(var(--theme-base), 0.3)}.dark-theme .sidebar{color:rgba(255,255,255,0.7);background-color:rgba(var(--theme-base), 1)}.dark-theme a.home{color:rgba(var(--theme-base), 1)}.dark-theme blockquote{border-left-color:rgba(var(--theme-base), 0.1)}.dark-theme .solid-footer{background-color:rgba(var(--theme-base), 1);color:rgba(255,255,255,0.6)}.dark-theme form{background-color:rgba(var(--theme-base), 0.1)}.bright-theme{background-color:rgba(var(--theme-base), 0.3)}.bright-theme .sidebar{color:rgba(0,0,0,0.7);background-color:rgba(var(--theme-base), 1)}.bright-theme .sidebar h1{color:rgba(0,0,0,0.8)}.bright-theme .sidebar a{color:#000;border-color:rgba(0,0,0,0.6)}.bright-theme .sidebar a.home{color:rgba(var(--theme-base), 1);background-color:rgba(0,0,0,0.8)}.bright-theme .sidebar ul.nav a:hover{background-color:rgba(0,0,0,0.06)}.bright-theme .sidebar ul.nav a.home:hover{background-color:rgba(0,0,0,0.9)}.bright-theme blockquote{border-left-color:rgba(var(--theme-base), 0.3)}.bright-theme .search-ui,.bright-theme .teaser{background-color:rgba(0,0,0,0.03)}.bright-theme .search-ui a,.bright-theme .teaser a{color:#000}.bright-theme .solid-footer{background-color:rgba(var(--theme-base), 1);color:rgba(0,0,0,0.6)}.bright-theme .solid-footer a{color:#000}@font-face{font-family:Placard;src:url("/fonts/placardmtstd-cond-webfont.woff2") format("woff2"),url("/fonts/placardmtstd-cond-webfont.woff") format("woff");font-display:swap}html,body{margin:0;padding:0}body{text-align:center;color:#444;font-family:Georgia, serif;font-weight:normal;line-height:28px;font-size:14px}@media (min-width: 500px){body{line-height:31px;font-size:16px}}@media (min-width: 1266px){body{display:flex;flex-direction:row}}@media (min-width: 1266px){.sidebar{width:45%;min-height:100vh}}.sidebar header{position:sticky;top:0}.main{background-color:#fff}@media (min-width: 1266px){.main{width:55%}}.container,.sidebar-container{width:80%;text-align:left;margin-left:auto;margin-right:auto}@media (min-width: 800px){.container,.sidebar-container{width:70%;max-width:700px}}@media (min-width: 1266px){.container,.sidebar-container{width:60%;max-width:600px}}.container{padding-top:3em;padding-bottom:4em}@media (min-width: 1266px){.container{margin-left:4em}}@media (min-width: 1266px){.sidebar-container{margin-right:3em}}.page-details{margin-top:5em;padding-bottom:5em}@media (min-width: 500px){.page-details{max-width:80%}}@media (min-width: 800px){.page-details{max-width:450px}}@media (min-width: 1266px){.page-details{max-width:100%}}a{text-decoration:none;border-bottom-style:solid;border-bottom-width:1px}ul,ol{padding-left:1em}ul.tags{list-style:none;margin-top:0.5em;margin-left:0;padding-left:0;font-size:0.9em}ul.tags li{line-height:1.5}a.tag:link,a.tag:visited{border-bottom-style:none}h1,h2,h3,h4{font-family:arial, sans-serif;padding-top:1em;line-height:1.2}h1{font-family:Placard, arial, sans-serif;font-size:3.8em;line-height:1;text-transform:uppercase;font-weight:normal;margin-top:0;margin-bottom:0;padding-top:0.3rem;padding-bottom:0.4rem}h2{font-size:1.6em}h3{font-size:1.2em}h4{font-size:1.1em}.no-wrap{white-space:nowrap}.avatar-large{width:120px;border-radius:4px;border:solid 2px #fff;box-shadow:#000 0 0 4px}.main img{width:100%;padding-top:1em;padding-bottom:1em}.by-line{font-size:0.8em}.excerpt{font-style:italic;font-size:1.1em}blockquote{margin-left:0;padding:0.01em 1.5em;border-left-style:solid;border-left-width:0.8em}.phonetic{font-size:1.5rem;margin-top:0}hr{border-style:none;border-bottom:solid 1px #eee;margin:2em 0}form{border-radius:2px;padding:1em 2em;margin:2em -2em 1em -2em}label small{opacity:0.6em;display:block}input,textarea{width:100%;border:solid 1px #bbb;padding:0.2em;font-size:1.2rem}textarea{height:8rem}.btn,button{cursor:pointer;font-size:1em;background-color:#555;color:#fff;font-family:Georgia, serif;border-style:none;padding:0.5em 1em;border-radius:3px}.honey{display:none}.needs-content{border-color:#af2a40}.blog-list-item{padding:1em 0 2em}.blog-list-item h2,.blog-list-item h3{margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0}.blog-list-item .by-line{margin-bottom:0}.blog-list-item .grab{margin-top:1em;margin-bottom:0}.blog-list-item img{margin:0;padding:0}img.flag{width:1em}a.more-link{background-color:#eee;display:inline-block}img.external-link{width:0.8em;padding-left:0.4em;vertical-align:middle;opacity:0.3}h2 img.external-link{width:0.6em}.tweet{font-size:0.9em;background-color:rgba(0,0,0,0.03);border-radius:4px;padding:2em 2em 1em;margin:1em -2em 0.5em}header ul.nav{font-family:Arial, sans-serif;font-weight:bold;font-size:0.9em;list-style:none;margin:0;padding:0}header ul.nav li{display:inline}header ul.nav a{display:inline-block;padding:4em 0.5em 0.2em 0.5em;border-bottom-style:none}header ul.nav a.home{padding-left:0.7em;padding-right:0.7em}header ul.nav a.blog{padding-left:1em}.search-ui,.teaser{font-size:1.4em;margin:0 0 2em 0;padding:0.5em 1em;border-radius:3px;background-color:rgba(255,255,255,0.05)}.search-ui span,.teaser span{display:block}.search-ui a,.teaser a{color:#fff}.invisible{display:none}.search-ui{margin:1em -1em;padding-top:1em}.search-results{font-size:0.8em}pre{overflow:auto}footer .solid-footer{font-size:0.7em;line-height:1.5;padding:3em 0}@media (min-width: 1266px){footer{position:fixed;width:45%;bottom:0;left:0}}footer .container{padding:0}@media (min-width: 1266px){footer .container{margin-right:3rem;margin-left:auto}}.thumbnail-grid{display:flex;flex-flow:row wrap;align-items:flex-start;justify-content:space-between}.thumbnail-grid a:link,.thumbnail-grid a:visited{border-bottom-style:none;width:22%}.thumbnail-grid a:link:hover img,.thumbnail-grid a:link:focus img,.thumbnail-grid a:visited:hover img,.thumbnail-grid a:visited:focus img{filter:grayscale(0%)}.thumbnail-grid img{border:solid 4px #fff;padding:0;margin:0;filter:grayscale(90%);transition-duration:0.5s}.embed-container{position:relative;width:100%;padding-bottom:56.25%;height:0;margin-top:2em}.embed-container iframe{position:absolute;top:0;left:0;width:100%;height:100%}html{background-color:#d6d6d6}a{border-bottom-color:#9bf}a:link,a:visited{color:#46c}a:hover,a:focus{color:#2755de;border-bottom-color:#2755de}blockquote{border-left-color:#ebebeb}.solid-footer{color:#adadad;background-color:#333}@media (min-width: 1266px){.solid-footer{background-color:rgba(0,0,0,0.05)}}.solid-footer a{color:#fff;border-style:none}.blog-list-item h2 a,.blog-list-item h3 a{color:#444}form{background-color:#f9f9f9}.sidebar{background-color:#333;color:#d6d6d6}.sidebar h1{color:#fff}.sidebar a{color:#fff;border-color:#fff}.sidebar a.home{color:#333;background-color:#fff}.sidebar ul.nav a:hover{background-color:rgba(255,255,255,0.06)}.sidebar ul.nav a.home:hover{background-color:#fff}a.floating-lozenge{border-style:none}a.floating-lozenge img{border-radius:5px;box-shadow:0 1px 5px 0px rgba(0,0,0,0.37);padding-top:0;padding-bottom:0}a.floating-lozenge:hover img,a.floating-lozenge:focus img{box-shadow:0 1px 10px 0px rgba(0,0,0,0.45)}</style><title>Isomorphic Rendering on the JAMstack</title><meta name="description" content="A simplified yet powerful model for delivering ready-to-consume web pages which enhance to a dynamic client-side rendering approach"><link rel="alternate" href="/feed.xml" title="Pensamplivox" type="application/atom+xml"><link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/images/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/images/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@philhawksworth"><meta name="twitter:creator" content="@philhawksworth"><meta property="og:url" content="https://www.hawksworx.com/"><meta property="og:title" content="Phil Hawksworth"><meta property="og:description" content="A simplified yet powerful model for delivering ready-to-consume web pages which enhance to a dynamic client-side rendering approach"><meta property="og:image" content="https://www.hawksworx.com/card-image/-blog-isomorphic-rendering-on-the-jam-stack-card.png"></head><body><div style="background: yellow; color: blue;">Under Construction</div><div class="sidebar"><header><div class="sidebar-container"><ul class="nav"><li><a href="/records" class="home">pvxrecords</a></li><li><a href="/records" class="blog">records</a></li><li><a href="/artists">artists</a></li><li><a href="/history">history</a></li><li><a href="/contact">contact</a></li></ul><div class="search-ui invisible"><input type="text" id="search-str" class="search-str"><ol class="search-results"><ol></ol></ol></div><div class="page-details"><p class="by-line">August 1st 2016 by <a href="/about">Phil Hawksworth</a></p><h1>Isomorphic Rendering on the&nbsp;JAMstack</h1><ul class="tags"><li><a href="/tags/web" class="tag">#web</a></li><li><a href="/tags/development" class="tag">#development</a></li><li><a href="/tags/static" class="tag">#static</a></li><li><a href="/tags/jamstack" class="tag">#jamstack</a></li></ul></div></div></header></div><div class="main"><div class="container"><div class="excerpt"><p>I have been experimenting with something that seemed obvious to me for a while. A web development model which gives a pre-rendered, ready-to-consume, straight-into-the-eyeballs web page at every URL of a site. One which, once loaded then behaves like a client-side, single page app.</p><p>The fact that so many frameworks set about this with all manner of complex add-ons and machinery gave me cause to think I was missing something big. So I built a simple proof of concept with a static site generator to see if this model could work. I'm pretty pleased with it. Let me talk you through the approach and show you the result.</p><p><img src="/images/Comedy_in_the_Crown.jpg" alt="comedyinthecrown.com" title="comedyinthecrown.com - delivered via an enhanced JAM&nbsp;stack"></p></div><p>First thing's first. Let's look at the site. It's a simple site, not a big complex application, but that's precisely the type of thing I'm seeing regularly over-engineered, so it fits my purpose. Take a quick peek, then come back to read about how it was put together.</p><blockquote><p><a href="https://www.comedyinthecrown.com">https://www.comedyinthecrown.com</a></p></blockquote><p>Still with me? Ok. Let's list out the principles I wanted to demonstrate with this site:</p><ol><li>A consumable page of content at every URL without the need for JavaScript to display things in the browser</li><li>A valid, bookmark-able entry point to the site at every URL</li><li>Client-side rendering with JavaScript <em>as an enhancement</em> for reduced data over the wire and rapid (and perhaps fancy) page transition</li><li>Simple server-side architecture which could be served from any static web server</li><li>Content management through a CMS outside of a development environment</li></ol><h2>JAM Stack</h2><p>At its heart, this project would use a static site generator to build out a deployable site. This should satisfy point 4 above if we do it right and don't add anything that muddys the waters.</p><p>We'll use Gulp to run a build and generate our static assets with NodeJS on the server, and some APIs to get data. I've been calling this kind of build Short Stack development, but it fits nicely with what <a href="https://vimeo.com/163522126">Mathias Biilmann</a> of <a href="https://netlify.com">Netlify</a> calls the <a href="https://jamstack.org/">JAM Stack</a>. That is:</p><ul><li><strong>J</strong>avaScript</li><li><strong>A</strong>PIs</li><li><strong>M</strong>arkup</li></ul><h2>Abstracting the content management</h2><p>My first step was to look at a way to abstract the content which the site would deliver so that it could be managed via a CMS. I chose to use <a href="https://contentful.com">Contentful</a> which is a headless CMS as a service. It takes care of all of the CMS user interface, publishing flows and user roles. In Contentful I could define any content data model that I wanted and have it expose the data as JSON over an API.</p><p>I modeled the two main parts of <a href="https://www.comedyinthecrown.com">comedyinthecrown.com</a> that I wanted to be easily managed. Information about the gig nights, and the acts who would perform. These form the basis of what is dynamic on the site.</p><h2>Consuming the data</h2><p>Next, I wanted to consume the data from my CMS in 2 places:</p><ol><li>During a build of the site, to generate static versions of every page.</li><li>In the browser for client-side render of subsequent page loads.</li></ol><p>For the sake of portability, efficiency, and developing away from the network (like many things I make, this site would be developed mostly on my daily train ride) I chose to locally cache the data from the CMS within the site as a local instance of the API.</p><ul><li><a href="https://comedyinthecrown.com/dates">comedyinthecrown.com/dates</a> renders data from <a href="https://comedyinthecrown.com/api/nights.json">comedyinthecrown.com/api/nights.json</a></li><li><a href="https://comedyinthecrown.com/acts">comedyinthecrown.com/acts</a> renders data from <a href="https://comedyinthecrown.com/api/nights.json">comedyinthecrown.com/api/acts.json</a></li><li>..and so on</li></ul><p>This has a few advantages:</p><h3>It loosens the coupling between the site and the hosted CMS</h3><p>If for any reason, Contentful were to go away, the site would still function and all of our content would still be abstracted in a structured form. We could move our CMS elsewhere if we had to.</p><h3>It speeds up our build</h3><p>The build process doesn't need to get the latest content from the CMS every time we run it. By stashing the content locally, our build process can avoid going to the network while we our doing our development.</p><h3>We can serve our own data API</h3><p>Since we've grabbed the data, we can make it available on our own domain for our templates to use when rendering in the client. This reduces our dependencies when serving the site. And since we'll be serving everything as static files from a CDN, this can be rapid.</p><h2>Templating and generating the site</h2><p>For the site to rendered on the server, and also to support client-side rendering, I chose a templating language which can be used both on the server and the client. There were several options, but I chose <a href="https://mozilla.github.io/nunjucks/">Nunjucks</a> which has some nice features and a syntax I like.</p><p>With Nunjucks in place, I used Gulp to control some build activities:</p><ol><li>Download and stash the content in a local version of the API</li><li>Render the HTML pages from the Nunjucks templates and our content data</li><li>Precompile the same Nunjucks templates for use client-side with JavaScript</li><li>Do the usual squashing, optimising and baking to create a deployable directory of static assets.</li><li>Bake our local API to our deployable directory as a set of json files</li></ol><p>Now we have a site which has a fully populated pages, an API we can get more data from, and JavaScript templates which can render subsequent pages. Adding event listeners to all of our internal links with JavaScript as a progressive enhancement allows us to enable the client-site rendering.</p><h2>Hosting and deployments that keep things fresh</h2><p>Our content can feel fresh if we make it simple to get data or code changes, run a build, and push the output to a server somewhere. That sounds like a lot to do though, and things will only really stay fresh if we can make this as friction free as possible.</p><p>Enter Netlify which serves not only as our static site host, but and also a build server. Netlify can run the same build as we run locally with Gulp and deploy the result to its static hosting infrastructure. Better than that, it can be triggered to build whenever we push code changes to our git repository.</p><p>This gives developers a frictionless way to deploy versions of our site. <code>git push</code> ..done!</p><p>Now, how about for content authors? We want changes published in our CMS on Contentful to trigger a build too. We can do this thanks to webhooks which both Netlify and Contentful support. When content is published on Contentful, it fires a webhook on Netlify which then causes our build to run. The content is pulled in from the CMS and our build gets all the latest data. Nice.</p><h2>So how did we do?</h2><p>The result of this is a reasonably simple development architecture which keeps all of the guesswork out of what will run when people visit our site. What we see in development is the same as in any environment we care to deploy to.</p><p>The delivery performance of this model is great. The pages are prerendered and cached and ready to be displayed in the browser with no additional work. We get a working page into the user's eyes pretty damn quickly. After the page as loaded, JavaScript (if available) loads our client-side templates and add new behaviours to our internal links.</p><div class="embed-container"><iframe src="https://www.youtube.com/embed/XN9CpRT7SB4" frameborder="0" allowfullscreen></iframe></div><p>From this point onwards, when an internal link is clicked, it no longer requests a new page, instead it makes a request for the data it needs from our API. Minified, gzipped JSON is delivered from our CDN and is then rendered by our client-side templates. It uses a fraction of the bandwidth and browser effort of a full page reload, so this goes FAST.</p><p>By taking care of the browser's History state via the History APi, we keep the Back and Forward button of our browser working as expected and everything feels pretty slick.</p><p>This is the kind of behaviour that has become popular in single page applications (SPAs), but with the distinction that here the pages all work by default with no need for JavaScript The client-side rendering is a progressive enhancement.</p><h2>Taking this further</h2><p>This model already makes good use of static and cached assets, but we can go further by removing the need to go back to the network for templates and data sources if we have encountered them before. Service Workers can help with that.</p><p>A prerequisite for this is serving the site over https, which was <a href="https://www.netlify.com/docs/ssl">trivial on Netlify</a>. (Seriously. It took 10 seconds.)</p><div class="embed-container"><iframe src="https://www.youtube.com/embed/k-9T0FYd-QU" frameborder="0" allowfullscreen></iframe></div><p>You can <a href="https://github.com/philhawksworth/comedy-in-the-crown">check out the code</a> for the site (warts and all) on Github.</p></div><footer><div class="solid-footer"><div class="container"><div class="teaser"><span>Previously posted:</span> <a href="/blog/progressive-enhancement-design-smackdown/">Progressive Enhancement Design Smackdown</a></div><p>The source code of this site is available on <a href="https://www.github.com/philhawksworth/hawksworx.com" target="new" rel="noopener">GitHub</a> and is hosted and updated by <a href="https://www.netlify.com" target="new" rel="noopener">Netlify</a> automatically after each <a href="https://www.github.com/philhawksworth/hawksworx.com/commit/master" target="new" rel="noopener">code commit</a></p><p>Other than where specified, the content on this site is published under a <a href="http://creativecommons.org/licenses/by/3.0/" target="new" rel="noopener">Creative Commons Attribution 3.0 licence</a>.</p><p><a href="/feed.xml">Subscribe to a feed</a> of blog posts on this site.</p></div></div></footer></div><script>function btnHandler(e,t){var n=document.querySelector(e);n&&n.addEventListener("click",function(e){e.preventDefault(),t()},!1)}function flagIfEmpty(e){e.value.length<1&&e.classList.add("needs-content")}btnHandler("#btn-opt-in",function(){var e=new Date,t=e.getTime()+31536e6;e.setTime(t),document.cookie="nf_ab=oh-so-orange; expires="+e.toUTCString(),window.location.reload(!0)}),btnHandler("#btn-opt-out",function(){document.cookie="nf_ab=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",window.location.reload(!0)}),function(){var e=document.querySelectorAll("form");if(0!=e.length)for(var t=0;t<e.length;t++)e[t].addEventListener("submit",function(e){e.preventDefault();for(var t=e.target,n=t.querySelectorAll(".needs-content"),r=0;r<n.length;r++)n[r].classList.remove("needs-content");for(var o=t.querySelectorAll("input"),l=0;l<o.length;l++)flagIfEmpty(o[l]);for(var i=t.querySelectorAll("textarea"),c=0;c<i.length;c++)flagIfEmpty(i[c]);if(1<(n=t.querySelectorAll(".needs-content")).length)return!1;t.submit()},!1)}(),function(){var l=null,e=document.querySelector(".search-ui"),i=document.querySelector(".search-results"),n=document.querySelector("#search-str"),c=document.querySelector("footer"),a=function(){for(;i.firstChild;)i.removeChild(i.firstChild);c.classList.remove("invisible")};btnHandler("#search-link",function(){fetch("/search.json").then(function(e){return e.json()}).then(function(e){l=e.search}),e.classList.toggle("invisible"),n.focus(),n.addEventListener("keyup",function(e){var t=n.value;2<t.length?function(e){e=e.toLowerCase();var t=[];for(var n in l)-1!=l[n].text.indexOf(e)&&t.push(l[n]);for(var n in a(),c.classList.add("invisible"),t){var r=document.createElement("li"),o=document.createElement("a");o.textContent=t[n].title,o.setAttribute("href",t[n].url),r.appendChild(o),i.appendChild(r)}}(t):a()})})}();</script></body></html>